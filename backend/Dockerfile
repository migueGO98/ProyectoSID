FROM eclipse-temurin:17.0.11_9-jdk-alpine AS build
WORKDIR /app
# Copiar documentaci贸n de la API para OpenAPI Generator
COPY api-sid.yml .
WORKDIR /app/backend
# Copiar los archivos necesarios para instalar las dependencias
COPY pom.xml mvnw mvnw.cmd ./
COPY .mvn .mvn
RUN ./mvnw dependency:resolve
# Copiar el c贸digo fuente
COPY src ./src
# Compilar y ejecutar pruebas unitarias
#RUN ./mvnw clean test
# Compilar y empaquetar la aplicaci贸n
RUN ./mvnw clean package -DskipTests


# Crear una imagen con la aplicaci贸n empaquetada
FROM eclipse-temurin:17.0.11_9-jre-alpine
EXPOSE 8080
WORKDIR /app
COPY --from=build /app/backend/target/*.jar app.jar
ENTRYPOINT ["java", "-jar", "app.jar"]